#!/usr/bin/env bash
# Updates /etc/hosts to map localhost to 127.0.0.2 and facebook.com to 8.8.8.8

set -euo pipefail

HOSTS_FILE="/etc/hosts"
BACKUP_FILE="/etc/hosts.bak"

if [[ "$EUID" -ne 0 ]]; then
  echo "This script must be run as root"
  exit 1
fi

if [[ ! -f "$BACKUP_FILE" ]]; then
  cp "$HOSTS_FILE" "$BACKUP_FILE"
fi

sed -i '/[[:space:]]localhost$/d' "$HOSTS_FILE"
sed -i '/[[:space:]]facebook\.com$/d' "$HOSTS_FILE"

echo "127.0.0.2 localhost" >> "$HOSTS_FILE"
echo "8.8.8.8 facebook.com" >> "$HOSTS_FILE"

echo "/etc/hosts updated:"
echo "localhost -> 127.0.0.2"
echo "facebook.com -> 8.8.8.8"
